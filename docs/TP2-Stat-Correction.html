<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Prérequis 4modIA - Correction du TP2 - Statistique avec R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./LogoINSAToulouse.jpg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Prérequis 4modIA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./TP1-InitR.html" rel="" target="">
 <span class="menu-text">TP1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./TP2-Stat.html" rel="" target="">
 <span class="menu-text">TP2</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#statistiques-descriptives" id="toc-statistiques-descriptives" class="nav-link active" data-scroll-target="#statistiques-descriptives"><span class="header-section-number">1</span> Statistiques descriptives</a>
  <ul class="collapse">
  <li><a href="#récupération-du-jeu-de-données" id="toc-récupération-du-jeu-de-données" class="nav-link" data-scroll-target="#récupération-du-jeu-de-données"><span class="header-section-number">1.1</span> Récupération du jeu de données</a></li>
  <li><a href="#statistiques-descriptives-unidimensionnelles" id="toc-statistiques-descriptives-unidimensionnelles" class="nav-link" data-scroll-target="#statistiques-descriptives-unidimensionnelles"><span class="header-section-number">1.2</span> Statistiques descriptives unidimensionnelles</a></li>
  <li><a href="#statistiques-descriptives-bidimensionnelles" id="toc-statistiques-descriptives-bidimensionnelles" class="nav-link" data-scroll-target="#statistiques-descriptives-bidimensionnelles"><span class="header-section-number">1.3</span> Statistiques descriptives bidimensionnelles</a></li>
  </ul></li>
  <li><a href="#illustration-de-notions-de-statistique-inférentielle-paramétrique-dans-le-cas-gaussien" id="toc-illustration-de-notions-de-statistique-inférentielle-paramétrique-dans-le-cas-gaussien" class="nav-link" data-scroll-target="#illustration-de-notions-de-statistique-inférentielle-paramétrique-dans-le-cas-gaussien"><span class="header-section-number">2</span> Illustration de notions de statistique inférentielle paramétrique dans le cas gaussien</a>
  <ul class="collapse">
  <li><a href="#estimateurs-pour-m-et-sigma2" id="toc-estimateurs-pour-m-et-sigma2" class="nav-link" data-scroll-target="#estimateurs-pour-m-et-sigma2"><span class="header-section-number">2.1</span> Estimateurs pour <span class="math inline">\(m\)</span> et <span class="math inline">\(\sigma^2\)</span></a></li>
  <li><a href="#intervalle-de-confiance-pour-la-moyenne-m" id="toc-intervalle-de-confiance-pour-la-moyenne-m" class="nav-link" data-scroll-target="#intervalle-de-confiance-pour-la-moyenne-m"><span class="header-section-number">2.2</span> Intervalle de confiance pour la moyenne <span class="math inline">\(m\)</span></a></li>
  <li><a href="#test-sur-la-moyenne" id="toc-test-sur-la-moyenne" class="nav-link" data-scroll-target="#test-sur-la-moyenne"><span class="header-section-number">2.3</span> Test sur la moyenne</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Correction du TP2 - Statistique avec R</h1>
<p class="subtitle lead">ModIA - 4ème année - 2025-2026</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Ce TP se décompose en deux parties indépendantes :</p>
<ul>
<li><p>Partie 1 : elle est consacrée aux notions de statistiques descriptives uni- et bi-dimensionnelles.</p></li>
<li><p>Partie 2 : elle est consacrée à l’illustration de notions de statistique inférentielle paramétrique revues dans les séances de remise à niveau. On n’abordera ici que le cas gaussien.</p></li>
</ul>
<p><em>Remarque : pensez à enlever les “eval: false” au fur et à mesure de l’avancement dans le TP dans la partie 2 pour avoir les résultats dans votre compte-rendu final de TP.</em></p>
<section id="statistiques-descriptives" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Statistiques descriptives</h1>
<p>Cette section s’appuie sur la <a href="https://cmaugis.github.io/TutorielR-V2025/Part3-StatR.html" target="_blank">partie 3 du tutoriel</a>. Avant de commencer ce TP, vous devez avoir fait la partie <code>ggplot2()</code> du TP1 et/ou avoir lu la présentation de <code>ggplot2</code> du <a href="https://cmaugis.github.io/TutorielR-V2025/Part4-Ravance.html#visualisation-avec-ggplot2" target="_blank">tutoriel 4</a>.</p>
<section id="récupération-du-jeu-de-données" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="récupération-du-jeu-de-données"><span class="header-section-number">1.1</span> Récupération du jeu de données</h2>
<p>On va étudier le jeu de données <strong>wine</strong> disponible sur la page moodle du cours. Commencez par récupérer ce jeu de données et sauvegardez le fichier dans votre dossier de travail.</p>
<p>Le jeu de données <strong>wine </strong> comprend des mesures physico-chimiques réalisées sur un échantillon de <span class="math inline">\(600\)</span> vins (rouges et blancs) du Portugal. Ces mesures sont complétées par une évaluation sensorielle de la qualité par un ensemble d’experts. Chaque vin est décrit par les variables suivantes :</p>
<ul>
<li><em>Qualite</em> : son évaluation sensorielle par les experts (“bad”,“medium”,“good”),</li>
<li><em>Type</em> : son type (1 pour un vin rouge, 0 pour un vin blanc),</li>
<li><em>AcidVol</em> : la teneur en acide volatile (en g/dm3 d’acide acétique),</li>
<li><em>AcidCitr</em> : la teneur en acide citrique (en g/dm3),</li>
<li><em>SO2lbr</em> : le dosage du dioxyde de soufre libre (en mg/dm3),</li>
<li><em>SO2tot</em> : le dosage du dioxyde de soufre total (en mg/dm3),</li>
<li><em>Densite</em> : la densité (en g/cm3),</li>
<li><em>Alcool</em> : le degré d’alcool (en % Vol.).</li>
</ul>
<p>Dans un premier temps, commencez par charger le jeu de données à l’aide de la fonction <code>read.table()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">"wine.txt"</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vous pouvez voir les premières lignes du jeu de données :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Qualite Type AcidVol AcidCitr SO2lbr SO2tot Densite Alcool
1352  medium    1    0.62     0.01      8     46 0.99332   11.8
5493  medium    0    0.34     0.10     17     63 0.99370    9.2
5153  medium    0    0.22     0.22     39    110 0.99855    9.0
5308  medium    0    0.35     0.46     61    183 0.99786    9.0
3866  medium    0    0.42     0.32     20    167 0.99479   10.6
694   medium    1    0.48     0.32     21    122 0.99840    9.4</code></pre>
</div>
</div>
<p>Le jeu de données contient 600 individus (correspondant aux 600 lignes) décrits par 8 variables (correspondant aux 8 colonnes).</p>
<p>Remarquons que l’on peut obtenir les noms des variables grâce à la commande <code>names(Data)</code>. Plus largement, on peut utiliser la commande <code>attributes()</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "Qualite"  "Type"     "AcidVol"  "AcidCitr" "SO2lbr"   "SO2tot"   "Densite" 
[8] "Alcool"  

$class
[1] "data.frame"

$row.names
  [1] "1352" "5493" "5153" "5308" "3866" "694"  "5085" "2280" "5231" "4388"
 [11] "4172" "4763" "4001" "3244" "4663" "3256" "3444" "3867" "3161" "6420"
 [21] "1590" "2155" "2258" "209"  "4560" "1981" "2166" "5430" "6496" "346" 
 [31] "1288" "3615" "1837" "5637" "2520" "3046" "2983" "840"  "3185" "4690"
 [41] "6347" "728"  "240"  "6318" "2501" "3003" "4537" "4799" "141"  "3664"
 [51] "5167" "5291" "3383" "2712" "449"  "214"  "3216" "4917" "5005" "3501"
 [61] "1291" "3137" "998"  "1350" "6336" "492"  "3901" "4878" "5343" "5096"
 [71] "4516" "1118" "2680" "452"  "3937" "776"  "528"  "3445" "203"  "1175"
 [81] "5796" "2334" "3564" "1921" "4995" "1070" "5286" "4421" "5630" "273" 
 [91] "896"  "5267" "742"  "956"  "4435" "414"  "2737" "1496" "455"  "3970"
[101] "286"  "1535" "3144" "5473" "6308" "5051" "3502" "4286" "1408" "2581"
[111] "6225" "4614" "3065" "54"   "6300" "2050" "5574" "3368" "2332" "4225"
[121] "5508" "2830" "5669" "6141" "6395" "5337" "878"  "4190" "5778" "3316"
[131] "5832" "5672" "1786" "2654" "1199" "5997" "1347" "4785" "5400" "2157"
[141] "3552" "788"  "2624" "1912" "499"  "2522" "6456" "4425" "618"  "1139"
[151] "5815" "1191" "1348" "771"  "5530" "858"  "4070" "5460" "4236" "5919"
[161] "6340" "5170" "3266" "3696" "6310" "6269" "3258" "6313" "362"  "2374"
[171] "4507" "1575" "3468" "5729" "6469" "510"  "6107" "1178" "4973" "4120"
[181] "5295" "2076" "3989" "4518" "3184" "1198" "1847" "2285" "6022" "6087"
[191] "113"  "5667" "3317" "933"  "4658" "1923" "4026" "2244" "226"  "1254"
[201] "747"  "2809" "1137" "2067" "2455" "6163" "3977" "50"   "3418" "5477"
[211] "2389" "6243" "65"   "3678" "3117" "4327" "4206" "1169" "4188" "5392"
[221] "1477" "3063" "6342" "4634" "3862" "1497" "193"  "2273" "3074" "583" 
[231] "6169" "3865" "5812" "2658" "4152" "753"  "4000" "5504" "1861" "6068"
[241] "4950" "4654" "1511" "1001" "2386" "1242" "2045" "2743" "1413" "2060"
[251] "5915" "469"  "5454" "4119" "397"  "1278" "2307" "1279" "4528" "761" 
[261] "3747" "199"  "802"  "4150" "271"  "5070" "6303" "146"  "3768" "4665"
[271] "2703" "5349" "1693" "1640" "5547" "354"  "4161" "3230" "1319" "3832"
[281] "2894" "3282" "5782" "570"  "5111" "6433" "229"  "5419" "2174" "1749"
[291] "4782" "5163" "6059" "4836" "5635" "6054" "6437" "3347" "684"  "48"  
[301] "2117" "1224" "96"   "4131" "2726" "2511" "6262" "3086" "1253" "4549"
[311] "723"  "5287" "3739" "1658" "76"   "1604" "149"  "554"  "349"  "639" 
[321] "416"  "2966" "378"  "475"  "1212" "5670" "15"   "4986" "324"  "3657"
[331] "5571" "881"  "322"  "1998" "3795" "5064" "232"  "5447" "2232" "5307"
[341] "3578" "4645" "6277" "6483" "1028" "5649" "1493" "52"   "4329" "5765"
[351] "4927" "4871" "5099" "419"  "2019" "3490" "5412" "4310" "2156" "4040"
[361] "4791" "6205" "1295" "4177" "2216" "6355" "4493" "4428" "3089" "2142"
[371] "4354" "5650" "2801" "2977" "919"  "1951" "3641" "5697" "6452" "3271"
[381] "4515" "3665" "4167" "6008" "6094" "605"  "5608" "2942" "2360" "4579"
[391] "4805" "239"  "612"  "4937" "3692" "4287" "2203" "1547" "5444" "872" 
[401] "4513" "6280" "5050" "2226" "5135" "5278" "2570" "4509" "2732" "1820"
[411] "5495" "1882" "789"  "4290" "1249" "3306" "5468" "2342" "2217" "1252"
[421] "1828" "832"  "4529" "2750" "5511" "4111" "2200" "695"  "611"  "1916"
[431] "1646" "1774" "1977" "5298" "1007" "3956" "5659" "6"    "1365" "619" 
[441] "3131" "2941" "2027" "3838" "6039" "5624" "5323" "2730" "1783" "1579"
[451] "3397" "3685" "5180" "1741" "5219" "5103" "997"  "1451" "2102" "309" 
[461] "3508" "4429" "2320" "4943" "1236" "5285" "1622" "2865" "254"  "581" 
[471] "4635" "198"  "5257" "5006" "2363" "922"  "399"  "3948" "2198" "5393"
[481] "4609" "5299" "2598" "1214" "5875" "3626" "4087" "783"  "1482" "290" 
[491] "5956" "3011" "2293" "6176" "3871" "5478" "1123" "319"  "2469" "4151"
[501] "2395" "4073" "2072" "1762" "1775" "3325" "1560" "3769" "5755" "4011"
[511] "6389" "4958" "3523" "1452" "4576" "5182" "1179" "1059" "6467" "369" 
[521] "5795" "1836" "1684" "1737" "988"  "5853" "1201" "866"  "110"  "775" 
[531] "5303" "1938" "1283" "5636" "1474" "3236" "2262" "2881" "892"  "2032"
[541] "129"  "6375" "1044" "540"  "3219" "3183" "1895" "2631" "1354" "655" 
[551] "4963" "3040" "4729" "6286" "5823" "4224" "729"  "719"  "5217" "3569"
[561] "1447" "1394" "4794" "1664" "501"  "3668" "3098" "1080" "2266" "186" 
[571] "5841" "3375" "1111" "430"  "677"  "3973" "6471" "1021" "3674" "6203"
[581] "2762" "572"  "5960" "970"  "460"  "4630" "5655" "5365" "2020" "3275"
[591] "5150" "3265" "3328" "3925" "1265" "768"  "670"  "1156" "2275" "974" </code></pre>
</div>
</div>
<p>La commande <code>str()</code> affiche quand à elle d’autres informations concernant les données. En particulier, on retrouve le type (data.frame) et la dimension (nombres d’observations et de variables) des données. En outre, pour chaque variable, on peut lire son nom, son format (entier, numérique, caractère) ainsi que ses premières valeurs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   600 obs. of  8 variables:
 $ Qualite : chr  "medium" "medium" "medium" "medium" ...
 $ Type    : int  1 0 0 0 0 1 0 0 0 0 ...
 $ AcidVol : num  0.62 0.34 0.22 0.35 0.42 0.48 0.21 0.28 0.3 0.4 ...
 $ AcidCitr: num  0.01 0.1 0.22 0.46 0.32 0.32 0.32 0.14 0.25 0.42 ...
 $ SO2lbr  : num  8 17 39 61 20 21 39 64 21 41 ...
 $ SO2tot  : int  46 63 110 183 167 122 113 159 124 176 ...
 $ Densite : num  0.993 0.994 0.999 0.998 0.995 ...
 $ Alcool  : num  11.8 9.2 9 9 10.6 9.4 10.2 10 10.8 9.4 ...</code></pre>
</div>
</div>
<p>On voit ici que les variables sont de différentes natures :</p>
<ul>
<li>Les variables <em>Qualite</em> et <em>Type</em> sont des variables <em>qualitatives</em></li>
<li>Les autres variables sont <em>quantitatives</em></li>
</ul>
<p>Attention à bien préciser à R les variables qui doivent être considérées comme qualitatives. Ici, on change donc la nature des variables <em>Qualite</em> et <em>Type</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Data<span class="sc">$</span>Qualite<span class="ot">=</span><span class="fu">as.factor</span>(Data<span class="sc">$</span>Qualite)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Data<span class="sc">$</span>Type<span class="ot">=</span><span class="fu">factor</span>(Data<span class="sc">$</span>Type,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"blanc"</span>,<span class="st">"rouge"</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Qualite  Type AcidVol AcidCitr SO2lbr SO2tot Densite Alcool
1352  medium rouge    0.62     0.01      8     46 0.99332   11.8
5493  medium blanc    0.34     0.10     17     63 0.99370    9.2
5153  medium blanc    0.22     0.22     39    110 0.99855    9.0
5308  medium blanc    0.35     0.46     61    183 0.99786    9.0
3866  medium blanc    0.42     0.32     20    167 0.99479   10.6
694   medium rouge    0.48     0.32     21    122 0.99840    9.4</code></pre>
</div>
</div>
<p>On peut obtenir un résumé rapide du jeu de données à l’aide de la fonction <code>summary()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Qualite       Type        AcidVol          AcidCitr          SO2lbr      
 bad   : 19   blanc:425   Min.   :0.1000   Min.   :0.0000   Min.   :  2.00  
 good  :110   rouge:175   1st Qu.:0.2400   1st Qu.:0.2400   1st Qu.: 15.75  
 medium:471               Median :0.3000   Median :0.3000   Median : 27.00  
                          Mean   :0.3512   Mean   :0.3141   Mean   : 29.41  
                          3rd Qu.:0.4300   3rd Qu.:0.3900   3rd Qu.: 41.00  
                          Max.   :1.0400   Max.   :1.0000   Max.   :112.00  
     SO2tot         Densite           Alcool     
 Min.   :  7.0   Min.   :0.9875   Min.   : 8.00  
 1st Qu.: 68.0   1st Qu.:0.9925   1st Qu.: 9.50  
 Median :114.5   Median :0.9949   Median :10.40  
 Mean   :111.2   Mean   :0.9947   Mean   :10.49  
 3rd Qu.:154.0   3rd Qu.:0.9970   3rd Qu.:11.30  
 Max.   :278.0   Max.   :1.0030   Max.   :14.00  </code></pre>
</div>
</div>
</section>
<section id="statistiques-descriptives-unidimensionnelles" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="statistiques-descriptives-unidimensionnelles"><span class="header-section-number">1.2</span> Statistiques descriptives unidimensionnelles</h2>
<section id="variable-qualitative" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="variable-qualitative"><span class="header-section-number">1.2.1</span> Variable qualitative</h3>
<p>On considère ici une variable qualitative <span class="math inline">\(X\)</span> dont on observe <span class="math inline">\(n\)</span> réalisations <span class="math inline">\(\underline{x}=(x_1,x_2,\ldots,x_n)\)</span>. Cette variable prend <span class="math inline">\(K\)</span> modalités <span class="math inline">\(m_1,\ldots,m_K\)</span>. Si les modalités n’ont pas d’ordre naturel, on parle de variable qualitative nominale (ex. <em>Type</em>), sinon c’est une variable qualitative ordinale (ex. <em>Qualite</em>).</p>
<p>La variable <em>Type</em> contient <span class="math inline">\(K=\)</span> 2 modalités qui sont blanc, rouge.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Data<span class="sc">$</span>Type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "blanc" "rouge"</code></pre>
</div>
</div>
<p>On récupère l’effectif <span class="math inline">\(n_k=\underset{i=1}{\stackrel{n}{\sum}} \mathbb{1}_{x_i=m_k}\)</span> pour chaque modalité <span class="math inline">\(m_k\)</span> avec <code>summary()</code> ou <code>table()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Data<span class="sc">$</span>Type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>blanc rouge 
  425   175 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>EffType <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(Data<span class="sc">$</span>Type))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>EffType</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 425 175</code></pre>
</div>
</div>
<p>On utilise aussi les fréquences <span class="math inline">\(f_k=\frac{n_k}{n}\)</span> donc <span class="math inline">\(\underset{k=1}{\stackrel{K}{\sum}} f_k=1\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Freq <span class="ot">=</span> EffType<span class="sc">/</span><span class="fu">length</span>(Data<span class="sc">$</span>Type)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">modalite=</span><span class="fu">levels</span>(Data<span class="sc">$</span>Type),<span class="at">Eff=</span>EffType,<span class="at">Freq=</span>Freq), <span class="at">caption =</span> <span class="st">'Description de la variable Type'</span>,<span class="at">booktabs =</span> <span class="cn">TRUE</span>,<span class="at">digits=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Description de la variable Type</caption>
<thead>
<tr class="header">
<th style="text-align: left;">modalite</th>
<th style="text-align: right;">Eff</th>
<th style="text-align: right;">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">blanc</td>
<td style="text-align: right;">425</td>
<td style="text-align: right;">0.708</td>
</tr>
<tr class="even">
<td style="text-align: left;">rouge</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">0.292</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Pour une variable qualitative ordinale, on utilise également les effectifs cumulés <span class="math inline">\(N_k=\underset{\ell=1}{\stackrel{k}{\sum}} n_\ell\)</span> et les fréquences cumulées <span class="math inline">\(F_k=\underset{\ell=1}{\stackrel{k}{\sum}} f_\ell\)</span>.</p>
<p>Pour une variable qualitative, on utilise la représentation par camembert (pie) ou diagramme en bâton (barplot)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>g1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(Data, <span class="fu">aes</span>(<span class="at">x=</span>Type))<span class="sc">+</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Effectifs"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>g2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(Data, <span class="fu">aes</span>(<span class="at">x =</span> Type)) <span class="sc">+</span>  </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> (..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..)))<span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Frequences"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>quan <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(Data<span class="sc">$</span>Type))<span class="sc">/</span><span class="fu">nrow</span>(Data)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> <span class="fu">levels</span>(Data<span class="sc">$</span>Type),<span class="at">value =</span> quan)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>g3<span class="ot">&lt;-</span><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span>value, <span class="at">fill=</span>group))<span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">"identity"</span>)<span class="sc">+</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start=</span><span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g3,g1,g2,<span class="at">ncol=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Pour une variable qualitative ordinale, on peut également tracer les fréquences cumulées :</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="variable-quantitative" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="variable-quantitative"><span class="header-section-number">1.2.2</span> Variable quantitative</h3>
<p>Nous allons ici nous intéresser à l’étude d’une variable quantitative <span class="math inline">\(X\)</span> dont on a <span class="math inline">\(n\)</span> observations <span class="math inline">\(\underline{x}=(x_1,\ldots,x_n)\)</span>. On va illustrer cette section avec la variable <em>Alcool</em>. Vous pouvez reprendre l’étude pour les autres variables quantitatives du jeu de données.</p>
<section id="indices-statistiques" class="level4" data-number="1.2.2.1">
<h4 data-number="1.2.2.1" class="anchored" data-anchor-id="indices-statistiques"><span class="header-section-number">1.2.2.1</span> Indices statistiques</h4>
<p>Nous rappelons les principaux indicateurs statistiques que l’on peut évaluer pour une série de mesures <span class="math inline">\(\underline{x}\)</span> : la moyenne, la médiane, la variance, l’écart-type ….</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Mean/var/sd</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">min/max/range</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">médiane / quartiles / quantiles</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>La moyenne de <span class="math inline">\(\underline{x}\)</span> : <span class="math inline">\(\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Data<span class="sc">$</span>Alcool)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.48592</code></pre>
</div>
</div>
<p>La variance <span class="math inline">\(s_x^2 = \frac{1}{n}\sum_{i=1}^n (x_i - \bar{x})^2\)</span>, la variance corrigée <span class="math inline">\(var(\underline{x})=\frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2\)</span> et l’écart-type corrigé <span class="math inline">\(\sqrt{var(\underline{x})}\)</span>. Attention les fonctions <code>var()</code> et <code>sd()</code> renvoient les valeurs corrigées de la variance et de l’écart-type respectivement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(Data<span class="sc">$</span>Alcool)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.316059</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(Data<span class="sc">$</span>Alcool)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.147196</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>La commande <code>range()</code> renvoie respectivement le minimum et le maximum. On peut aussi utiliser <code>min()</code>et <code>max()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(Data<span class="sc">$</span>Alcool)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8 14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(Data<span class="sc">$</span>Alcool)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(Data<span class="sc">$</span>Alcool)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14</code></pre>
</div>
</div>
<p>On peut alors récupérer l’étendue (<span class="math inline">\(max(\underline{x}) - min(\underline{x})\)</span> ) avec le code suivant :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(<span class="fu">range</span>(Data<span class="sc">$</span>Alcool))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>La médiane est une valeur qui divise l’échantillon en deux sous-échantillons de même cardinal : <span class="math inline">\(\sum_{i=1}^n \mathbb{1}_{x_i\geq m} \geq \frac{n}{2} \textrm{ et } \sum_{i=1}^n \mathbb{1}_{x_i\leq m} \geq \frac{n}{2}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(Data<span class="sc">$</span>Alcool)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(Data<span class="sc">$</span>Alcool)[<span class="dv">296</span><span class="sc">:</span><span class="dv">305</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 10.3 10.3 10.3 10.3 10.4 10.4 10.4 10.4 10.4 10.4</code></pre>
</div>
</div>
<p>La médiane est le deuxième des trois quartiles :</p>
<ul>
<li>le premier quartile <span class="math inline">\(q_{0.25}\)</span> est une valeur qui sépare les 25<span class="math inline">\(\%\)</span> des valeurs inférieures de l’échantillon du reste</li>
<li>le deuxième quartile <span class="math inline">\(q_{0.5}\)</span> est la médiane</li>
<li>le troisième quartile <span class="math inline">\(q_{O.75}\)</span> est une valeur qui sépare les 25% des valeurs supérieures de l’échantillon du reste. On retrouve ces valeurs dans la représentation par boxplot (voir plus bas).</li>
</ul>
<p>Les quartiles sont des cas particuliers de la notion de quantile. Le <span class="math inline">\(\alpha\)</span>-quantile empirique est défini par <span class="math inline">\(q_{\alpha} = x_{(i)}\)</span> avec <span class="math inline">\(\alpha\in]\frac{i-1}{n}, \frac{i}{n}]\)</span> où <span class="math inline">\(x_{(1)}\leq x_{(2)}\leq \ldots \leq x_{(n)}\)</span> sont les valeurs ordonnées de la série statistique.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(Data<span class="sc">$</span>Alcool)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0%  25%  50%  75% 100% 
 8.0  9.5 10.4 11.3 14.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(Data<span class="sc">$</span>Alcool,<span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 90% 
12.1 </code></pre>
</div>
</div>
<p>Pour calculer l’écart interquantile, il suffit de faire la différence entre les troisième et premier quantiles, à savoir</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>q.Alc <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="at">x =</span> Data<span class="sc">$</span>Alcool, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">25</span>,.<span class="dv">75</span>), <span class="at">names=</span><span class="cn">FALSE</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span>(q.Alc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.8</code></pre>
</div>
</div>
<p>et les valeurs d’adjacence sont obtenues de la manière suivante :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>L<span class="ot">=</span>q.Alc <span class="sc">+</span> <span class="fu">diff</span>(q.Alc) <span class="sc">*</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="fl">1.5</span>) ; L</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  6.8 14.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># valeur adjacente inférieure :</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(Data<span class="sc">$</span>Alcool[Data<span class="sc">$</span>Alcool<span class="sc">&gt;=</span>L[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># valeur adjacente supérieure :</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(Data<span class="sc">$</span>Alcool[Data<span class="sc">$</span>Alcool<span class="sc">&lt;=</span>L[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14</code></pre>
</div>
</div>
<p>Par ailleurs, toutes ces informations sont stockées dans la commande <code>summary()</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Data<span class="sc">$</span>Alcool)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   8.00    9.50   10.40   10.49   11.30   14.00 </code></pre>
</div>
</div>
<p>où sont affichés respectivement le minimum, le premier quartile, la médiane, la moyenne, le troisième quartile et le maximum.</p>
</div>
</div>
</div>
</section>
<section id="représentations-graphiques" class="level4" data-number="1.2.2.2">
<h4 data-number="1.2.2.2" class="anchored" data-anchor-id="représentations-graphiques"><span class="header-section-number">1.2.2.2</span> Représentations graphiques</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Histogramme</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Fonction de répartition empirique</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Boîte à moustaches / boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>L’histogramme est une représentation graphique qui permet de visualiser la répartition d’une variable quantitative. Les valeurs sont regroupées en intervalles <span class="math inline">\(]a_k,a_{k+1}[\)</span> et la hauteur associée est <span class="math inline">\(h_k=\frac{f_k}{a_{k+1} - a_k}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>g1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(Data,<span class="fu">aes</span>(<span class="at">x=</span>Alcool))<span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">15</span>,<span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"white"</span>)<span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Histo. des effectifs"</span>)<span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"Alcool"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>g2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(Data,<span class="fu">aes</span>(<span class="at">x=</span>Alcool))<span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..),<span class="at">bins=</span><span class="dv">15</span>,<span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"white"</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Histo. des frequences"</span>)<span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"Alcool"</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g1,g2,<span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/hist-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>L’option <code>breaks="Sturges"</code> donne le choix par défaut de R pour le nombre de classes. D’autres options sont possibles (soit on précise les classes elles mêmes dans un vecteur, soit on précise un nombre arbitraire de classes, soit on lui précise l’algorithme pour calculer le nombre de classes parmi <code>"Sturges"</code>, <code>"Scott"</code> ou <code>"FD"</code> pour Freedman-Diaconis). On peut récupérer les informations de construction de l’histogramme en stockant le résultat de <code>hist()</code> dans une variable :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fu">hist</span>(Data<span class="sc">$</span>Alcool,<span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(H)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "breaks"   "counts"   "density"  "mids"     "xname"    "equidist"

$class
[1] "histogram"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>H<span class="sc">$</span>breaks <span class="co"># les (K+1) bordures des classes [a_k,a_{k+1}]</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>H<span class="sc">$</span>counts <span class="co"># le nombre de points dans chaque classe</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>H<span class="sc">$</span>density <span class="co"># la hauteur des K classes</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>H<span class="sc">$</span>mids <span class="co"># le milieu des K classes</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>H<span class="sc">$</span>xname <span class="co"># le nom de la variable</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>H<span class="sc">$</span>equidist <span class="co"># découpage régulier </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>La fonction de répartition empirique est la fonction en escalier définie par <span class="math inline">\(t\in\mathbb{R}\mapsto F_n(t) = \frac{1}{n} \sum_{i=1}^n \mathbb{1}_{x_i\leq t}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Data, <span class="fu">aes</span>(Alcool)) <span class="sc">+</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">"step"</span>)<span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Variable Alcool"</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Fonction de répartition empirique"</span>)<span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>La boîte à moustaches est un graphique qui résume la série statistique à partir de ses valeurs extrêmes et ses quartiles. En effet, on retrouve sur cette représentation</p>
<ul>
<li>les quartiles</li>
<li>la valeur adjacente supérieure <span class="math inline">\(v+\)</span>, qui est la plus grande valeur de l’échantillon inférieure ou égale à <span class="math inline">\(L+ = q_{0.75} + 1.5 (q _{0.75} − q_{0.25})\)</span></li>
<li>la valeur adjacente inférieure <span class="math inline">\(v−\)</span>, qui est la plus petite valeur de l’échantillon supérieure ou égale à <span class="math inline">\(L− = q_{0.25} − 1.5 (q_{0.75} − q_{0.25})\)</span></li>
<li>les valeurs extrêmes (outliers) qui sont les valeurs de l’échantillon n’appartenant pas à l’intervalle <span class="math inline">\([v−, v+]\)</span>.</li>
</ul>
<p>Voici les boxplots pour les variables quantitatives de notre exemple.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    smiths</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>g1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(<span class="fu">melt</span>(Data[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]),<span class="fu">aes</span>(<span class="at">x=</span>variable,<span class="at">y=</span>value))<span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No id variables; using all as measure variables</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>g1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/boxplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Nous allons pour la suite nous concentrer sur la variable <em>SO2lbr</em>. En plus du graphique, on peut récupérer de la fonction <code>boxplot()</code> différentes informations :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(Data<span class="sc">$</span>SO2lbr,<span class="at">horizontal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/boxplotNit-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "stats" "n"     "conf"  "out"   "group" "names"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Data,<span class="fu">aes</span>(<span class="at">y=</span>SO2lbr))<span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/boxplotNit-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Dans <code>B$stats</code>, on retrouve les quartiles, la médiane et les valeurs adjacentes :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>B<span class="sc">$</span>stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  2.0
[2,] 15.5
[3,] 27.0
[4,] 41.0
[5,] 73.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(Data<span class="sc">$</span>SO2lbr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="at">x =</span> Data<span class="sc">$</span>SO2lbr, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">25</span>,.<span class="dv">75</span>), <span class="at">names=</span><span class="cn">FALSE</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>q</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15.75 41.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>L<span class="ot">=</span>q <span class="sc">+</span> <span class="fu">diff</span>(q) <span class="sc">*</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>,<span class="fl">1.5</span>) </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(Data<span class="sc">$</span>SO2lbr[Data<span class="sc">$</span>SO2lbr<span class="sc">&gt;=</span>L[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(Data<span class="sc">$</span>SO2lbr[Data<span class="sc">$</span>SO2lbr<span class="sc">&lt;=</span>L[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 73.5</code></pre>
</div>
</div>
<p>Dans <code>B$out</code> renvoie toutes les valeurs aberrantes (en dehors des barres inférieure et supérieure c’est à dire en dehors de l’intervalle <span class="math inline">\([v-,v+]\)</span>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>B<span class="sc">$</span>out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  89.0 105.0  85.0 112.0  79.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>Data<span class="sc">$</span>SO2lbr[<span class="fu">which</span>(Data<span class="sc">$</span>SO2lbr<span class="sc">&lt;</span>B<span class="sc">$</span>stats[<span class="dv">1</span>] <span class="sc">|</span> Data<span class="sc">$</span>SO2lbr<span class="sc">&gt;</span>B<span class="sc">$</span>stats[<span class="dv">5</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  89.0 105.0  85.0 112.0  79.5</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="statistiques-descriptives-bidimensionnelles" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="statistiques-descriptives-bidimensionnelles"><span class="header-section-number">1.3</span> Statistiques descriptives bidimensionnelles</h2>
<section id="entre-2-variables-quantitatives" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="entre-2-variables-quantitatives"><span class="header-section-number">1.3.1</span> Entre 2 variables quantitatives</h3>
<p>Supposons dans cette partie que X et Y sont deux variables quantitatives et on observe une série de <span class="math inline">\(n\)</span> valeurs pour chacune : <span class="math inline">\(\underline{x}=(x_1,\ldots,x_n)\)</span> et <span class="math inline">\(\underline{y}=(y_1,\ldots,y_n)\)</span>.</p>
<p>On peut tout d’abord représenter le nuage de points de coordonnées <span class="math inline">\((x_i,y_i)\)</span> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Data,<span class="fu">aes</span>(<span class="at">x=</span>Alcool,<span class="at">y=</span>Densite))<span class="sc">+</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="corrélation" class="level4" data-number="1.3.1.1">
<h4 data-number="1.3.1.1" class="anchored" data-anchor-id="corrélation"><span class="header-section-number">1.3.1.1</span> Corrélation</h4>
<p>On peut calculer la covariance (généralisaton bidimensionnelle de la variance) entre ces deux séries de mesure à l’aide de la commande <code>cov()</code>: <span class="math display">\[
Cov(\underline{x},\underline{y}) = \frac{1}{n} \sum_{i=1}^n (x_i-\bar{x}) (y_i -\bar{y}).
\]</span> Mais la covariance dépendant des unités de mesure des deux variables considérées, on calcule plutôt la corrélation linéaire (renormalisation de la covariance par les écarts-type) qui appartient à l’intervalle <span class="math inline">\([-1,1]\)</span> à l’aide de <code>cor()</code>: <span class="math display">\[
cor(\underline{x},\underline{y}) = \frac{Cov(\underline{x},\underline{y})}{\sqrt{s_x^2\ \ s_y^2}}
\]</span></p>
<p>A l’aide de la fonction <em>corrplot()</em> (issue du package du même nom) on représente ici la matrice des corrélations entre les variables quantitatives de notre jeu de données:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(Data[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]),<span class="at">method=</span><span class="st">"ellipse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="régression-linéaire" class="level4" data-number="1.3.1.2">
<h4 data-number="1.3.1.2" class="anchored" data-anchor-id="régression-linéaire"><span class="header-section-number">1.3.1.2</span> Régression linéaire</h4>
<p>Le coefficient de corrélation linéaire entre les variables <em>Densité</em> et <em>Alcool</em> vaut -0.68. On peut vérifier que le nuage de points de ces deux variables s’aligner sur une droite de pente négative :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Data,<span class="fu">aes</span>(<span class="at">x=</span>Alcool,<span class="at">y=</span>Densite))<span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="entre-une-variable-quantitative-et-une-variable-qualitative" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="entre-une-variable-quantitative-et-une-variable-qualitative"><span class="header-section-number">1.3.2</span> Entre une variable quantitative et une variable qualitative</h3>
<p>Supposons dans cette partie que <span class="math inline">\(X\)</span> est une variable qualitative prenant <span class="math inline">\(J\)</span> modalités <span class="math inline">\(m_1, \ldots, m_J\)</span> et <span class="math inline">\(Y\)</span> une variable quantitative. On observe une série de <span class="math inline">\(n\)</span> valeurs pour chacune : <span class="math inline">\(\underline{x}=(x_1,\ldots,x_n)\)</span> et <span class="math inline">\(\underline{y}=(y_1,\ldots,y_n)\)</span>.</p>
<p>On note <span class="math inline">\(C_j=\{i\in\{1,\ldots,n\}; x_i=m_j\}\)</span> l’ensemble des individus prenant la modalité <span class="math inline">\(m_j\)</span> et <span class="math inline">\(n_j\)</span> son cardinal.</p>
<p>La moyenne de <span class="math inline">\(\underline{y}\)</span> peut alors se décomposer en une moyenne pondérée des moyennes de <span class="math inline">\(y\)</span> conditionnellement aux modalités de <span class="math inline">\(X\)</span> : <span class="math display">\[
\bar{y} = \frac{1}{n} \sum_{j=1}^J n_j\ \bar{y}_{[j]} \textrm{   avec   } \bar{y}_{[j]} = \frac{1}{n_j} \sum_{i\in C_j} y_i
\]</span> De même la variance se décompose en <span class="math inline">\(s_y^2 = \underbrace{s_{y,E}^2}_{\textrm{variance inter-classe}} + \underbrace{s_{y,R}^2}_{\textrm{variance intra-classe}}\)</span> avec</p>
<p><span class="math display">\[
s_{y,E}^2 = \frac{1}{n} \sum_{j=1}^J n_j\ (\bar{y}_{[j]} - \bar{y})^2
\]</span> et <span class="math display">\[
s_{y,R}^2 = \frac{1}{n} \sum_{j=1}^J n_j\ s_{y,[j]}^2 \textrm{ avec } s^2_{y,[j]} = \frac{1}{n_j}\sum_{i\in C_j} (y_i - \bar{y}_{[j]})^2
\]</span> On peut alors définir le <em>rapport de corrélation</em> <span class="math display">\[
\rho_{y|x} = \sqrt{\frac{s_{y,E}^2}{s_{y}^2}} = \sqrt{1 - \frac{s_{y,R}^2}{s_{y}^2}}\in[0,1].
\]</span> Plus <span class="math inline">\(\rho_{y|x}\)</span> est proche de <span class="math inline">\(0\)</span>, plus <span class="math inline">\(s_{y,E}^2\)</span> est proche de 0 et donc moins la variable qualitative <span class="math inline">\(X\)</span> a d’influence sur la variable quantitative <span class="math inline">\(Y\)</span>.</p>
<p>Graphiquement, on peut représenter la distribution de la variable quantitative conditionnellement aux modalités de la variable qualitative pour visualiser la liaison potentielle entre les deux variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>g1<span class="ot">&lt;-</span><span class="fu">ggplot</span>(Data,<span class="fu">aes</span>(<span class="at">x=</span>Qualite,<span class="at">y=</span>Alcool))<span class="sc">+</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>g2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(Data,<span class="fu">aes</span>(<span class="at">x=</span>Type,<span class="at">y=</span>Alcool))<span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g1,g2,<span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="entre-deux-variables-qualitatives" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="entre-deux-variables-qualitatives"><span class="header-section-number">1.3.3</span> Entre deux variables qualitatives</h3>
<p>Supposons dans cette partie que <span class="math inline">\(X\)</span> est une variable qualitative prenant <span class="math inline">\(J\)</span> modalités <span class="math inline">\(m_1,\ldots,m_J\)</span> et <span class="math inline">\(Y\)</span> est une vraiable qualitative prenant <span class="math inline">\(K\)</span> modalités <span class="math inline">\(\ell_1,\ldots,\ell_K\)</span>. On observe une série de <span class="math inline">\(n\)</span> valeurs pour chacune : <span class="math inline">\(\underline{x}=(x_1,\ldots,x_n)\)</span> et <span class="math inline">\(\underline{y}=(y_1,\ldots,y_n)\)</span>. Pour étudier l’influence de deux variables qualitatives entre elles, on se base sur la table de contingence qui est l’ensemble des effectifs conjoints <span class="math display">\[
n_{j,k} = \sum_{i=1}^n \mathrm{1}_{x_i = m_j\ \cap\ y_i=\ell_k},\ \ \forall j\in\{1,\ldots,J\},\ \forall k\in\{1,\ldots,K\}
\]</span> On définit les effectifs marginaux par <span class="math display">\[
n_{j,.}=\sum_{k=1}^K n_{j,k}\ \ \ \textrm{   et   } \ \ \ n_{.,k}=\sum_{j=1}^J n_{j,k}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>table.cont <span class="ot">=</span> <span class="fu">table</span>(Data<span class="sc">$</span>Qualite,Data<span class="sc">$</span>Type)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>table.cont</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
         blanc rouge
  bad       17     2
  good      89    21
  medium   319   152</code></pre>
</div>
</div>
<p>Graphiquement, on peut représenter un mosaiplot qui correspond à la représentation des profils-lignes <span class="math display">\[
\left(\frac{n_{j,1}}{n_{j,.}},\ldots,\frac{n_{j,K}}{n_{j,.}}\right)\in [0,1]^K
\]</span> ou des profils-colonnes</p>
<p><span class="math display">\[
\left(\frac{n_{1,k}}{n_{.,k}},\ldots,\frac{n_{J,k}}{n_{.,k}}\right)\in [0,1]^J
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="fu">table</span>(Data<span class="sc">$</span>Qualite,Data<span class="sc">$</span>Type))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="fu">table</span>(Data<span class="sc">$</span>Type,Data<span class="sc">$</span>Qualite))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="illustration-de-notions-de-statistique-inférentielle-paramétrique-dans-le-cas-gaussien" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Illustration de notions de statistique inférentielle paramétrique dans le cas gaussien</h1>
<p>On considère <span class="math inline">\(\underline{X}=(X_1,\ldots,X_n)\)</span> un <span class="math inline">\(n\)</span>-échantillon de loi <span class="math inline">\(\mathcal{N}(m,\sigma^2)\)</span>.</p>
<section id="estimateurs-pour-m-et-sigma2" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="estimateurs-pour-m-et-sigma2"><span class="header-section-number">2.1</span> Estimateurs pour <span class="math inline">\(m\)</span> et <span class="math inline">\(\sigma^2\)</span></h2>
<p>Pour plusieurs valeurs de <span class="math inline">\(n\)</span> :</p>
<ul>
<li>simulez un <span class="math inline">\(n\)</span>-échantillon observé <span class="math inline">\(\underline{x}\)</span> de <span class="math inline">\(\underline{X}\)</span> de loi <span class="math inline">\(\mathcal{N}(m,\sigma^2)\)</span> avec <span class="math inline">\(m=5\)</span> et <span class="math inline">\(\sigma^2=4\)</span> à l’aide de la fonction <code>rnorm()</code>.</li>
<li>A partir de <span class="math inline">\(\underline{x}\)</span>, donnez une estimation pour le paramètre de moyenne <span class="math inline">\(m\)</span> et pour le paramètre de variance <span class="math inline">\(\sigma^2\)</span>.</li>
<li>Que constatez-vous ?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">100</span>,<span class="dv">10000</span>,<span class="dv">100</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>mest<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>sigma2est<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span>  <span class="fu">rnorm</span>(<span class="at">n=</span>n[i],<span class="at">mean=</span><span class="dv">5</span>,<span class="at">sd=</span><span class="dv">2</span>)               </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  mest <span class="ot">=</span> <span class="fu">c</span>(mest, <span class="fu">mean</span>(x))    </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  sigma2est<span class="ot">=</span><span class="fu">c</span>(sigma2est, <span class="fu">var</span>(x))  </span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Valeurs obtenues pour l’estimation de <span class="math inline">\(m\)</span> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">n=</span>n,<span class="at">mest=</span>mest,<span class="at">sigma2est=</span>sigma2est)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>n,<span class="at">y=</span>mest))<span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">5</span>, <span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Valeurs obtenues pour l’estimation de <span class="math inline">\(\sigma^2\)</span> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>n,<span class="at">y=</span>sigma2est))<span class="sc">+</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">4</span>, <span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="intervalle-de-confiance-pour-la-moyenne-m" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="intervalle-de-confiance-pour-la-moyenne-m"><span class="header-section-number">2.2</span> Intervalle de confiance pour la moyenne <span class="math inline">\(m\)</span></h2>
<section id="cas-de-la-variance-connue" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="cas-de-la-variance-connue"><span class="header-section-number">2.2.1</span> Cas de la variance connue</h3>
<p>Nous allons tout d’abord nous intéresser à la construction d’un intervalle de confiance pour <span class="math inline">\(m\)</span> lorsque la variance <span class="math inline">\(\sigma^2\)</span> est connue, dont la formule est rappelée ici <span class="math display">\[
IC_{1-\alpha}(m) = \left[\bar X_n \pm z_{1-\frac{\alpha}{2}} \sqrt{\frac{\sigma^2}{n}}\right]
\]</span> où <span class="math inline">\(z_{1-\frac{\alpha}{2}}\)</span> est le <span class="math inline">\(1-\frac{\alpha}{2}\)</span>-quantile de la loi normale centrée réduite.</p>
<p>Reportez-vous aux slides de remise à niveau pour vous rappeler la construction.</p>
<ol type="1">
<li>Ecrivez une fonction <code>int.conf.moy1</code> calculant <span class="math inline">\(IC\)</span> au niveau de confiance <em>niv.conf</em> à partir d’un échantillon observé <span class="math inline">\(\underline{x}\)</span> et de la valeur de la variance <em>sigma2</em></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>int.conf.moy1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,niv.conf,sigma2){</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>niv.conf</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  IC <span class="ot">=</span> <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(sigma2<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(IC)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Etudiez le comportement de l’intervalle de confiance en fonction de <span class="math inline">\(n\)</span> et du niveau de confiance sur données simulées. Pour cela, pour différentes valeurs de <span class="math inline">\(n\)</span> et <em>niv.conf</em>,</li>
</ol>
<ul>
<li>simulez un échantillon <span class="math inline">\(x\)</span> de taille <span class="math inline">\(n\)</span> de v.a. gaussiennes de moyenne <span class="math inline">\(m=5\)</span> et de variance <span class="math inline">\(\sigma^2=4\)</span> à l’aide de la fonction <code>rnorm()</code></li>
<li>déduisez-en un intervalle de confiance pour <span class="math inline">\(m\)</span> au niveau de confiance <em>niv.conf</em> à l’aide de la fonction <code>int.conf.moy1</code> programmée précédemment</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">5000</span>,<span class="dv">10000</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>niv.conf <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.95</span>,<span class="fl">0.99</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(niv.conf)){</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">=</span> <span class="fu">rnorm</span>(n[i],<span class="at">mean=</span><span class="dv">5</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    IC<span class="ot">=</span><span class="fu">int.conf.moy1</span>(x,niv.conf[j],<span class="at">sigma2=</span><span class="dv">4</span>)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"n= "</span>, n[i],<span class="st">", niv.conf= "</span>,niv.conf[j],<span class="st">" : IC vaut ["</span>, <span class="fu">round</span>(IC[<span class="dv">1</span>],<span class="dv">3</span>),<span class="st">","</span>,<span class="fu">round</span>(IC[<span class="dv">2</span>],<span class="dv">3</span>),<span class="st">"], il est de longueur"</span>,<span class="fu">round</span>(IC[<span class="dv">2</span>]<span class="sc">-</span>IC[<span class="dv">1</span>],<span class="dv">3</span>), <span class="at">sep=</span><span class="st">""</span>))</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "n= 500, niv.conf= 0.9 : IC vaut [4.985,5.279], il est de longueur0.294"
[1] "n= 500, niv.conf= 0.95 : IC vaut [4.956,5.307], il est de longueur0.351"
[1] "n= 500, niv.conf= 0.99 : IC vaut [4.82,5.281], il est de longueur0.461"
[1] "n= 1000, niv.conf= 0.9 : IC vaut [4.923,5.131], il est de longueur0.208"
[1] "n= 1000, niv.conf= 0.95 : IC vaut [4.88,5.128], il est de longueur0.248"
[1] "n= 1000, niv.conf= 0.99 : IC vaut [4.882,5.208], il est de longueur0.326"
[1] "n= 5000, niv.conf= 0.9 : IC vaut [4.952,5.045], il est de longueur0.093"
[1] "n= 5000, niv.conf= 0.95 : IC vaut [4.901,5.012], il est de longueur0.111"
[1] "n= 5000, niv.conf= 0.99 : IC vaut [4.964,5.11], il est de longueur0.146"
[1] "n= 10000, niv.conf= 0.9 : IC vaut [4.971,5.036], il est de longueur0.066"
[1] "n= 10000, niv.conf= 0.95 : IC vaut [4.924,5.002], il est de longueur0.078"
[1] "n= 10000, niv.conf= 0.99 : IC vaut [4.954,5.057], il est de longueur0.103"</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Nous allons ici illustrer le fait que la proportion moyenne de fois où le paramètre <span class="math inline">\(m\)</span> appartient à l’intervalle de confiance vaut <em>niv.conf</em>.</li>
</ol>
<p>Pour cela, répétez <span class="math inline">\(K\)</span> fois l’expérience suivante</p>
<ul>
<li>simulez un échantillon <span class="math inline">\(x\)</span> de taille <span class="math inline">\(n=1000\)</span> de v.a. gaussiennes de moyenne <span class="math inline">\(m=5\)</span> et de variance <span class="math inline">\(\sigma^2=4\)</span> à l’aide de la fonction <code>rnorm()</code></li>
<li>déduisez-en un intervalle de confiance pour <span class="math inline">\(m\)</span> au niveau de confiance <em>niv.conf=0.95</em> à l’aide de la fonction <code>int.conf.moy1</code> programmée précédemment</li>
<li>comptabilisez si la vraie valeur de <span class="math inline">\(m\)</span> appartient à l’intervalle de confiance ou pas</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>propconf <span class="ot">&lt;-</span> <span class="cf">function</span>(K,m){</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>nb.app<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">mean=</span>m,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  IC<span class="ot">=</span><span class="fu">int.conf.moy1</span>(x,<span class="at">niv.conf=</span><span class="fl">0.95</span>,<span class="at">sigma2=</span><span class="dv">4</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  nb.app <span class="ot">=</span> nb.app <span class="sc">+</span> (m<span class="sc">&gt;=</span>IC[<span class="dv">1</span>]) <span class="sc">*</span> (m<span class="sc">&lt;=</span>IC[<span class="dv">2</span>])</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(nb.app<span class="sc">/</span>K)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>}  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Evaluez plusieurs fois pour <span class="math inline">\(K\)</span> valant <span class="math inline">\(100\)</span> et <span class="math inline">\(1000\)</span>. Qu’observez-vous ?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>nbrep<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>val1<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nbrep)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  val1<span class="ot">=</span><span class="fu">c</span>(val1,<span class="fu">propconf</span>(<span class="at">K=</span><span class="dv">100</span>,<span class="at">m=</span><span class="dv">5</span>))</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>val2<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nbrep)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  val2<span class="ot">=</span><span class="fu">c</span>(val2,<span class="fu">propconf</span>(<span class="at">K=</span><span class="dv">1000</span>,<span class="at">m=</span><span class="dv">5</span>))</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">val=</span><span class="fu">c</span>(val1,val2),<span class="at">K=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"K=100"</span>,nbrep),<span class="fu">rep</span>(<span class="st">"K=1000"</span>,nbrep)))</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>val))<span class="sc">+</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.95</span>, <span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cas-de-la-variance-inconnue" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="cas-de-la-variance-inconnue"><span class="header-section-number">2.2.2</span> Cas de la variance inconnue</h3>
<p>Nous allons maintenant nous intéresser à la construction d’un intervalle de confiance pour <span class="math inline">\(m\)</span> lorsque la variance <span class="math inline">\(\sigma^2\)</span> est inconnue, dont la formule est rappelée ici <span class="math display">\[
IC_{1-\alpha}(m) = \left[\bar X_n \pm t_{1-\frac{\alpha}{2}} \sqrt{\frac{S^2}{n}}\right]
\]</span> où <span class="math inline">\(t_{1-\frac{\alpha}{2}}\)</span> est le <span class="math inline">\(1-\frac{\alpha}{2}\)</span>-quantile de la loi de Student à <span class="math inline">\(n-1\)</span> degrés de liberté et <span class="math inline">\(S^2\)</span> est l’estimateur de la variance.</p>
<p>Reportez-vous aux slides de remise à niveau pour vous rappeler la construction.</p>
<ol type="1">
<li>Ecrivez une fonction <code>int.conf.moy2</code> calculant <span class="math inline">\(IC\)</span> au niveau de confiance <em>niv.conf</em> à partir d’un échantillon observé <span class="math inline">\(\underline{x}\)</span>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>int.conf.moy2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,niv.conf){</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>niv.conf</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  S2 <span class="ot">=</span>  <span class="fu">var</span>(x)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  IC <span class="ot">=</span> <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(S2<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(IC)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Etudiez le comportement de l’intervalle de confiance en fonction de <span class="math inline">\(n\)</span> et du niveau de confiance sur données simulées. Pour cela, pour différentes valeurs de <span class="math inline">\(n\)</span> et <em>niv.conf</em>,</li>
</ol>
<ul>
<li>simulez un échantillon <span class="math inline">\(x\)</span> de taille <span class="math inline">\(n\)</span> de v.a. gaussiennes de moyenne <span class="math inline">\(m=5\)</span> et de variance <span class="math inline">\(\sigma^2=4\)</span> à l’aide de la fonction <code>rnorm()</code></li>
<li>déduisez-en un intervalle de confiance pour <span class="math inline">\(m\)</span> au niveau de confiance <em>niv.conf</em> à l’aide de la fonction <code>int.conf.moy2</code> programmée précédemment</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">5000</span>,<span class="dv">10000</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>niv.conf <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.95</span>,<span class="fl">0.99</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(niv.conf)){</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">=</span> <span class="fu">rnorm</span>(n[i],<span class="at">mean=</span><span class="dv">5</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>    IC<span class="ot">=</span><span class="fu">int.conf.moy2</span>(x,niv.conf[j])</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"n= "</span>, n[i],<span class="st">", niv.conf= "</span>,niv.conf[j],<span class="st">" : IC vaut ["</span>, <span class="fu">round</span>(IC[<span class="dv">1</span>],<span class="dv">3</span>),<span class="st">","</span>,<span class="fu">round</span>(IC[<span class="dv">2</span>],<span class="dv">3</span>),<span class="st">"], il est de longueur"</span>,<span class="fu">round</span>(IC[<span class="dv">2</span>]<span class="sc">-</span>IC[<span class="dv">1</span>],<span class="dv">3</span>), <span class="at">sep=</span><span class="st">""</span>))</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "n= 500, niv.conf= 0.9 : IC vaut [4.989,5.277], il est de longueur0.287"
[1] "n= 500, niv.conf= 0.95 : IC vaut [4.891,5.25], il est de longueur0.359"
[1] "n= 500, niv.conf= 0.99 : IC vaut [4.738,5.188], il est de longueur0.45"
[1] "n= 1000, niv.conf= 0.9 : IC vaut [4.819,5.029], il est de longueur0.21"
[1] "n= 1000, niv.conf= 0.95 : IC vaut [4.83,5.07], il est de longueur0.24"
[1] "n= 1000, niv.conf= 0.99 : IC vaut [4.891,5.213], il est de longueur0.322"
[1] "n= 5000, niv.conf= 0.9 : IC vaut [4.956,5.049], il est de longueur0.093"
[1] "n= 5000, niv.conf= 0.95 : IC vaut [4.905,5.016], il est de longueur0.112"
[1] "n= 5000, niv.conf= 0.99 : IC vaut [4.942,5.087], il est de longueur0.146"
[1] "n= 10000, niv.conf= 0.9 : IC vaut [4.996,5.063], il est de longueur0.067"
[1] "n= 10000, niv.conf= 0.95 : IC vaut [4.972,5.05], il est de longueur0.078"
[1] "n= 10000, niv.conf= 0.99 : IC vaut [4.929,5.033], il est de longueur0.103"</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Comparez sur données simulées les intervalles de confiance obtenus dans le cas de la variance connue (<code>int.conf.moy1</code>), le cas de la variance inconnue (<code>int.conf.moy2</code>) et avec la fonction <code>t.test()</code>de R.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">mean=</span><span class="dv">5</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">int.conf.moy1</span>(x,<span class="at">niv.conf=</span><span class="fl">0.95</span>,<span class="at">sigma2=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.926437 5.174355</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">int.conf.moy2</span>(x,<span class="at">niv.conf=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.927728 5.173063</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x,<span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  x
t = 80.792, df = 999, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 4.927728 5.173063
sample estimates:
mean of x 
 5.050396 </code></pre>
</div>
</div>
</section>
</section>
<section id="test-sur-la-moyenne" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="test-sur-la-moyenne"><span class="header-section-number">2.3</span> Test sur la moyenne</h2>
<p>Considérons <span class="math inline">\(X_1,\ldots,X_n\)</span> des variables aléatoires i.i.d. de loi <span class="math inline">\(\mathcal{N}(m,\sigma^2)\)</span> (où <span class="math inline">\(m\)</span> est inconnue) et soit <span class="math inline">\(m_0 \in \mathbb{R}\)</span> donnée.</p>
<section id="cas-de-la-variance-connue-1" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="cas-de-la-variance-connue-1"><span class="header-section-number">2.3.1</span> Cas de la variance connue</h3>
<ol type="1">
<li>Dans les trois tests suivants au niveau <span class="math inline">\(\alpha\)</span>,</li>
</ol>
<ul>
<li>Test 1 : <span class="math inline">\(\mathcal{H}_0 : m=m_0 \quad \quad \mbox{contre} \quad \quad \mathcal{H}_1^+ : m&gt; m_0\)</span></li>
<li>Test 2 : <span class="math inline">\(\mathcal{H}_0 : m=m_0 \quad \quad \mbox{contre} \quad \quad \mathcal{H}_1^{-} : m&lt; m_0\)</span></li>
<li>Test 3 : <span class="math inline">\(\mathcal{H}_0 : m=m_0 \quad \quad \mbox{contre} \quad \quad \mathcal{H}_1 : m\neq m_0\)</span></li>
</ul>
<p>précisez</p>
<ul>
<li>la statistique de test et sa loi sous <span class="math inline">\(\mathcal{H}_0\)</span></li>
<li>la forme de la zone de rejet</li>
<li>l’expression de la pvaleur en fonction de <span class="math inline">\(\phi\)</span> qui désigne la fonction de répartition d’une <span class="math inline">\(\mathcal{N}(0,1)\)</span></li>
</ul>
<ol start="2" type="1">
<li>Complétez la fonction suivante <code>test.moy1()</code> qui évalue la p-valeur du test <span class="math inline">\(\mathcal{H}_0 : m=m_0\)</span> contre l’alternative</li>
</ol>
<ul>
<li><code>two.sided</code> pour le test bilatéral avec <span class="math inline">\(\mathcal{H}_1 : m\neq m_0\)</span></li>
<li><code>greater</code>pour le test unilatéral avec <span class="math inline">\(\mathcal{H}_1 : m&gt; m_0\)</span></li>
<li><code>less</code>pour le test unilatéral avec <span class="math inline">\(\mathcal{H}_1 : m &lt; m_0\)</span></li>
</ul>
<p>à partir d’un échantillon observé <span class="math inline">\(\underline{x}\)</span> (supposé gaussien) et la valeur de la variance <span class="math inline">\(\sigma^2\)</span>. Vous pourrez vous aider de la fonction <code>pnorm()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>test.moy1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,sigma2,m0,<span class="at">alternative=</span><span class="st">"greater"</span>){</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  Zn.obs <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(x))<span class="sc">*</span>(<span class="fu">mean</span>(x)<span class="sc">-</span>m0)<span class="sc">/</span><span class="fu">sqrt</span>(sigma2)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(alternative<span class="sc">==</span><span class="st">"two.sided"</span>){      </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>      pval <span class="ot">=</span>  <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(Zn.obs))) </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(alternative<span class="sc">==</span><span class="st">"greater"</span>){      </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>        pval <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(Zn.obs)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(alternative<span class="sc">==</span><span class="st">"less"</span>){       </span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>          pval <span class="ot">=</span> <span class="fu">pnorm</span>(Zn.obs)</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(pval)</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Afin d’estimer la taille du test, complétez la fonction <code>estim.prop.test.moy1()</code> qui estime la proportion moyenne de fois où le test rejette l’hypothèse nulle <span class="math inline">\(\mathcal{H_0}\)</span>. Pour cela, répétez <span class="math inline">\(K\)</span> fois l’expérience suivante</li>
</ol>
<ul>
<li>simulez un échantillon <span class="math inline">\(x\)</span> de taille <span class="math inline">\(n=1000\)</span> de v.a. gaussiennes de moyenne <span class="math inline">\(m=5\)</span> et de variance <span class="math inline">\(\sigma^2=4\)</span> à l’aide de la fonction <code>rnorm()</code></li>
<li>calculez la p-valeur obtenue avec la fonction <code>test.moy1</code> programmée précédemment pour le test <span class="math inline">\(\mathcal{H}_0: m=5\)</span> contre <span class="math inline">\(\mathcal{H}_1^+: m&gt;5\)</span>.<br>
</li>
<li>comptabilisez si l’hypothèse nulle est rejetée au niveau <span class="math inline">\(\alpha = 5\%\)</span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>estim.prop.test.moy1 <span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">m=</span><span class="dv">5</span>,<span class="at">sigma2=</span><span class="dv">4</span>,<span class="at">m0=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,<span class="at">K=</span><span class="dv">100</span>,<span class="at">alternative=</span><span class="st">"greater"</span>){</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  nb.rejets<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>      x<span class="ot">=</span><span class="fu">rnorm</span>(n,m,<span class="fu">sqrt</span>(sigma2))</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>      pval<span class="ot">=</span><span class="fu">test.moy1</span>(x,sigma2,m0,alternative)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>      nb.rejets <span class="ot">=</span> nb.rejets <span class="sc">+</span> (pval<span class="sc">&lt;=</span>alpha)</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(nb.rejets<span class="sc">/</span>K)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Qu’observez-vous ? Répétez cette étape plusieurs fois pour <span class="math inline">\(K=100\)</span> et <span class="math inline">\(K=1000\)</span>, que remarquez-vous ?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>nbrep<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>val1<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nbrep)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  val1<span class="ot">=</span><span class="fu">c</span>(val1,<span class="fu">estim.prop.test.moy1</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">m=</span><span class="dv">5</span>,<span class="at">sigma2=</span><span class="dv">4</span>,<span class="at">m0=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,<span class="at">K=</span><span class="dv">100</span>,<span class="at">alternative=</span><span class="st">"greater"</span>))</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>val2<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nbrep)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  val2<span class="ot">=</span><span class="fu">c</span>(val2,<span class="fu">estim.prop.test.moy1</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">m=</span><span class="dv">5</span>,<span class="at">sigma2=</span><span class="dv">4</span>,<span class="at">m0=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,<span class="at">K=</span><span class="dv">1000</span>,<span class="at">alternative=</span><span class="st">"greater"</span>))</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">val=</span><span class="fu">c</span>(val1,val2),<span class="at">K=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"K=100"</span>,nbrep),<span class="fu">rep</span>(<span class="st">"K=1000"</span>,nbrep)))</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>K,<span class="at">y=</span>val))<span class="sc">+</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.05</span>, <span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="4" type="1">
<li>Etude de la puissance du test <span class="math inline">\(\mathcal{H}_0: m=m_0\)</span> contre <span class="math inline">\(\mathcal{H}_1^+: m&gt;m_0\)</span></li>
</ol>
<ul>
<li>Montrez que la puissance théorique du test est donnée par l’expression suivante <span class="math display">\[
\Pi: \theta\in ]m_0,+\infty[ \mapsto 1 - \Phi\left(z_{1-\alpha} - \sqrt{n}\ \frac{\theta - m_0}{\sigma}\right)
\]</span> où <span class="math inline">\(z_{1-\alpha}\)</span> est le (1-)-quantile de la loi normale <span class="math inline">\(\mathcal{N}(0,1)\)</span> et <span class="math inline">\(\Phi\)</span> est la fonction de répartition de la loi normale <span class="math inline">\(\mathcal{N}(0,1)\)</span>.</li>
</ul>
<p>Créez une fonction <code>puiss.test.moy.1()</code> pour calculer cette fonction puissance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>puiss.test.moy<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">sigma2=</span><span class="dv">4</span>,<span class="at">m0=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,mmax){</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">=</span> <span class="fu">seq</span>(m0,mmax,<span class="fl">0.01</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  puiss <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha) <span class="sc">-</span> (<span class="fu">sqrt</span>(n<span class="sc">/</span>sigma2)<span class="sc">*</span>(theta<span class="sc">-</span>m0)))</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(puiss)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A l’aide de la fonction <code>puiss.test.moy.1()</code>, tracez sur un même graphique la fonction puissance en faisant varier le niveau <span class="math inline">\(\alpha\)</span> du test (<span class="math inline">\(1\%\)</span>, <span class="math inline">\(5\%\)</span>, <span class="math inline">\(10\%\)</span>) et commentez.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>mmax<span class="ot">=</span><span class="dv">6</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">5</span>,mmax,<span class="fl">0.01</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">puiss =</span> <span class="fu">c</span>(<span class="fu">puiss.test.moy.1</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">sigma2=</span><span class="dv">4</span>,<span class="at">m0=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.01</span>,mmax),<span class="fu">puiss.test.moy.1</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">sigma2=</span><span class="dv">4</span>,<span class="at">m0=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,mmax),<span class="fu">puiss.test.moy.1</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">sigma2=</span><span class="dv">4</span>,<span class="at">m0=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.1</span>,mmax)),</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"0.01"</span>,<span class="fu">length</span>(theta)),<span class="fu">rep</span>(<span class="st">"0.05"</span>,<span class="fu">length</span>(theta)),<span class="fu">rep</span>(<span class="st">"0.1"</span>,<span class="fu">length</span>(theta))),</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">theta=</span><span class="fu">rep</span>(theta,<span class="dv">3</span>))</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>theta,<span class="at">y=</span>puiss,<span class="at">colour=</span>alpha))<span class="sc">+</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A l’aide de la fonction <code>puiss.test.moy.1()</code>, tracez sur un même graphique la fonction puissance en faisant varier la taille de l’échantillon <span class="math inline">\(n\)</span> et commentez.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>mmax<span class="ot">=</span><span class="fl">6.5</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">5</span>,mmax,<span class="fl">0.01</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">puiss =</span> <span class="fu">c</span>(<span class="fu">puiss.test.moy.1</span>(<span class="at">n=</span><span class="dv">100</span>,<span class="at">sigma2=</span><span class="dv">4</span>,<span class="at">m0=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,mmax),<span class="fu">puiss.test.moy.1</span>(<span class="at">n=</span><span class="dv">500</span>,<span class="at">sigma2=</span><span class="dv">4</span>,<span class="at">m0=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,mmax),<span class="fu">puiss.test.moy.1</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">sigma2=</span><span class="dv">4</span>,<span class="at">m0=</span><span class="dv">5</span>,<span class="at">alpha=</span><span class="fl">0.05</span>,mmax)),</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">n=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"100"</span>,<span class="fu">length</span>(theta)),<span class="fu">rep</span>(<span class="st">"500"</span>,<span class="fu">length</span>(theta)),<span class="fu">rep</span>(<span class="st">"1000"</span>,<span class="fu">length</span>(theta))),</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">theta=</span><span class="fu">rep</span>(theta,<span class="dv">3</span>))</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>theta,<span class="at">y=</span>puiss,<span class="at">colour=</span>n))<span class="sc">+</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="TP2-Stat-Correction_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cas-de-la-variance-inconnue-1" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="cas-de-la-variance-inconnue-1"><span class="header-section-number">2.3.2</span> Cas de la variance inconnue</h3>
<p>On suppose maintenant que la variance <span class="math inline">\(\sigma^2\)</span> est inconnue et on s’intéresse uniquement au Test 1 <span class="math display">\[
\mathcal{H}_0 : m=m_0 \quad \quad \mbox{contre} \quad \quad \mathcal{H}_1^+ : m&gt; m_0
\]</span> 1. Rappelez la statistique de test, la loi sous <span class="math inline">\(\mathcal{H}_0\)</span> et la forme de la zone de rejet pour le test 1 quand la variance est inconnue</p>
<ol start="2" type="1">
<li>Construisez une fonction <code>test.moy2()</code> pour évaluer la pvaleur du test à partir d’un échantillon observé <span class="math inline">\(\underline{x}\)</span>. Vous pourrez vous aider de la fonction <code>pt()</code> pour la fonction de répartiion d’une loi de Student.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>test.moy2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,m0){</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  Tn_obs <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(x))<span class="sc">*</span>(<span class="fu">mean</span>(x)<span class="sc">-</span>m0)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(Tn_obs,<span class="at">df=</span><span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pval)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Comparez la pvaleur obtenue avec <code>test.moy2()</code> et la sortie de <code>t.test()</code> de R sur des données simulées.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">1000</span>,<span class="at">mean =</span><span class="dv">5</span>,<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">test.moy2</span>(x,<span class="at">m0=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7123989</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span> (x,<span class="at">mu=</span><span class="dv">5</span>,<span class="at">alternative=</span><span class="st">"greater"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  x
t = -0.56059, df = 999, p-value = 0.7124
alternative hypothesis: true mean is greater than 5
95 percent confidence interval:
 4.858467      Inf
sample estimates:
mean of x 
 4.964049 </code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>